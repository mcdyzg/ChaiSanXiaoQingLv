<!DOCTYPE html>
<html>

<head>
    <meta charset="utf-8">
    <title>拆散小情侣</title>
    <!--http://www.html5rocks.com/en/mobile/mobifying/-->
    <meta name="viewport" content="width=device-width,height=device-height,user-scalable=no,initial-scale=1, minimum-scale=1,maximum-scale=1,target-densitydpi=device-dpi" />
    <!--https://developer.apple.com/library/safari/documentation/AppleApplications/Reference/SafariHTMLRef/Articles/MetaTags.html-->
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <meta name="format-detection" content="telephone=no">
    <!-- force webkit on 360 -->
    <meta name="renderer" content="webkit" />
    <meta name="force-rendering" content="webkit" />
    <!-- force edge on IE -->
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
    <meta name="msapplication-tap-highlight" content="no">
    <!-- force full screen on some browser -->
    <meta name="full-screen" content="yes" />
    <meta name="x5-fullscreen" content="true" />
    <meta name="360-fullscreen" content="true" />
    <!-- force screen orientation on some browser -->
    <!-- portrait - 竖屏 landscape - 横屏 -->
    <meta name="screen-orientation" content="landscape" />
    <meta name="x5-orientation" content="landscape">
    <meta name="browsermode" content="application">
    <meta name="x5-page-mode" content="app">
    <style type="text/css">
        body{
            padding: 0;
            margin: 0;
        }
    </style>
</head>

<body>
    <script src="//miz-cdn.b0.upaiyun.com/miz-js-lib/jquery-2.2.3.min.js"></script>
    <script src="//static.nightwatch.xin/lib/phaser/phaser.min.js"></script>
    <script type="text/javascript">
!function(t){function e(a){if(i[a])return i[a].exports;var s=i[a]={exports:{},id:a,loaded:!1};return t[a].call(s.exports,s,s.exports,e),s.loaded=!0,s.exports}var i={};return e.m=t,e.c=i,e.p="",e(0)}([function(t,e){!function(t,e){function i(t){this.init=function(){this.config=t,s=l.add.group(),s.enableBody=!0,s.createMultiple(t.selfPool,t.selfPic),s.setAll("anchor.y",1),s.setAll("outOfBoundsKill",!0),s.setAll("checkWorldBounds",!0),this.maxWidth=l.width-80,l.time.events.loop(Phaser.Timer.SECOND*t.rate,this.createQL,this)},this.createQL=function(){var e=s.getFirstExists(!1);if(e){var i=Math.random();i=i<.5?i+=.5:i,e.loadTexture(this.config.selfPic),e.alpha=1,e.scale.setTo(i),e.reset(l.rnd.integerInRange(0,this.maxWidth),0),e.body.velocity.y=l.rnd.integerInRange(t.minSpeed,t.maxSpeed),e.inputEnabled=!0,e.events.onInputDown.add(this.hitted,this)}},this.hitted=function(t){r++,t.inputEnabled=!1;var e=t.animations.add("hitted");t.play("hitted",100,!1),e.onComplete.add(this.fade,this,t)},this.fade=function(t){var e=l.add.tween(t).to({alpha:0},300,"Linear",!0);e.onComplete.add(this.killed,this,t)},this.killed=function(t){t.kill()}}function a(t){this.init=function(){this.config=t,this.DogGroup=l.add.group(),this.DogGroup.enableBody=!0,this.DogGroup.createMultiple(t.selfPool,t.selfPic),this.DogGroup.setAll("anchor.y",1),this.DogGroup.setAll("outOfBoundsKill",!0),this.DogGroup.setAll("checkWorldBounds",!0),this.maxWidth=l.width-80,l.time.events.loop(Phaser.Timer.SECOND*t.rate,this.createDog,this)},this.createDog=function(){var e=this.DogGroup.getFirstExists(!1);if(e){var i=Math.random();i=i<.5?i+=.5:i,e.loadTexture(this.config.selfPic),e.alpha=1,e.scale.setTo(i),e.reset(l.rnd.integerInRange(0,this.maxWidth),0),e.body.velocity.y=l.rnd.integerInRange(t.minSpeed,t.maxSpeed)}}}var s,n=e(window).width(),o=e(window).height(),r=0,h={selfPool:40,selfPic:"qinglvdog",rate:.3,maxSpeed:300,minSpeed:50},d={selfPool:20,selfPic:"dog",rate:.3,maxSpeed:300,minSpeed:50,punished:!0},l=new Phaser.Game(n,o,Phaser.AUTO,"");l.States={},l.States.boot=function(){this.preload=function(){"undefined"!=typeof GAME&&(this.load.baseURL=GAME+"/"),l.device.desktop||(this.scale.scaleMode=Phaser.ScaleManager.EXACT_FIT,this.scale.forcePortrait=!0,this.scale.refresh())},this.create=function(){l.state.start("preload")}},l.States.preload=function(){this.preload=function(){l.load.spritesheet("daojishi","assets/img/daojishi.png",200,200,3),l.load.image("bg","assets/img/bg.png"),l.load.spritesheet("qinglvdog","assets/img/qinglvdog.png",80,77,2),l.load.image("dog","assets/img/dog.png"),l.load.image("shengyu","assets/img/shengyu.png"),l.load.image("chaisan","assets/img/chaisan.png"),l.load.bitmapFont("number","assets/img/number.png","assets/img/number.xml")},this.create=function(){l.state.start("main")}},l.States.main=function(){this.create=function(){this.leftTime=15,l.physics.startSystem(Phaser.Physics.ARCADE);var t=l.add.sprite(0,0,"bg");t.width=l.width,t.height=l.height;var e=l.add.sprite(l.world.centerX-100,l.world.centerY-100,"daojishi"),i=e.animations.add("daojishi");e.play("daojishi",1,!1),i.onComplete.add(this.startGame,this,e);var a=l.add.sprite(0,0,"shengyu");a.fixedToCamera=!0,a.scale.setTo(.75),a.cameraOffset.setTo(l.camera.width-150,l.camera.height-85);var s=l.add.sprite(0,0,"chaisan");s.fixedToCamera=!0,s.scale.setTo(.75),s.cameraOffset.setTo(l.camera.width-150,l.camera.height-60),this.leftTimeText=l.add.bitmapText(0,0,"number","00:15",26),this.leftTimeText.fixedToCamera=!0,this.leftTimeText.cameraOffset.setTo(l.camera.width-80,l.camera.height-88),this.chaiisanNum=l.add.bitmapText(0,0,"number",r.toString(),26),this.chaiisanNum.fixedToCamera=!0,this.chaiisanNum.cameraOffset.setTo(l.camera.width-80,l.camera.height-64)},this.update=function(){this.chaiisanNum.text=r},this.startGame=function(t){t.visible=!1,this.createQingLv(),l.time.events.repeat(Phaser.Timer.SECOND,15,this.refreshTime,this)},this.createQingLv=function(){this.qinglv=new i(h),this.qinglv.init(),this.qinglv=new i(h),this.qinglv.init(),this.dog=new a(d),this.dog.init()},this.refreshTime=function(){this.leftTime--;var t=this.leftTime;this.leftTime<10&&(t="0"+this.leftTime),this.leftTimeText.text="00:"+t,0===this.leftTime&&(l.paused=!0,localStorage.score=r,window.location.href="./result.html")}},l.States.over=function(){this.create=function(){}},l.state.add("boot",l.States.boot),l.state.add("preload",l.States.preload),l.state.add("main",l.States.main),l.state.add("over",l.States.over),l.state.start("boot")}(window,jQuery)}]);
    </script>
</body>

</html>
